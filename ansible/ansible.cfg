[defaults]
# Inventory configuration
inventory = hosts.ini

# Suppress deprecation warnings
deprecation_warnings = False

# SSH connection optimization
# Enable pipelining to reduce SSH connections (20-30% faster)
pipelining = True

# Increase parallel execution from default 5 to 10
forks = 10

# Display settings
# community.general.yaml callback removed in community.general>=12; use default + YAML formatting
stdout_callback = ansible.builtin.default
callback_result_format = yaml
bin_ansible_callbacks = True

# Fact caching for faster reruns
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 86400

# Retry settings
retry_files_enabled = False

[ssh_connection]
# SSH executable configuration
# Uses a wrapper script that checks for Tailscale SSH and falls back to regular ssh
# The wrapper script is created by setup-ssh action in GitHub Actions in the ansible directory
# For local development, the wrapper script should exist in the ansible directory
# Use the wrapper script from the ansible directory (same directory as this config file)
# Ansible will look for executables in PATH, so ensure the ansible directory is in PATH
# or use an absolute path. For GitHub Actions, the setup-ssh action adds it to PATH.
ssh_executable = tailscale-ssh-wrapper

# SSH ControlMaster for connection reuse (reduces SSH handshakes)
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=30

# Enable pipelining at SSH level
pipelining = True

# Connection timeout
timeout = 30
