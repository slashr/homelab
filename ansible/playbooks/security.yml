---
# Security hardening playbook for public cloud nodes
# Deploys fail2ban and UFW firewall to protect against attacks
#
# Staged rollout order: toby-gcp1 → phyllis-arm2 → stanley-arm1 → pam-amd1 → angela-amd2
#
# Performance optimization: gather_facts: false
# - fail2ban and firewall roles do not use any Ansible facts
# - Skipping fact gathering saves ~4-5 seconds per host
# - Total time saved: ~20-25 seconds across 5 hosts
# - Verified: All tasks use only hard-coded values or inventory_hostname

- name: Deploy security hardening to toby-gcp1
  hosts: toby-gcp1
  gather_facts: false
  become: true
  roles:
    - role: ../roles/fail2ban
    - role: ../roles/firewall

- name: Deploy security hardening to phyllis-arm2
  hosts: phyllis-arm2
  gather_facts: false
  become: true
  roles:
    - role: ../roles/fail2ban
    - role: ../roles/firewall

- name: Deploy security hardening to stanley-arm1
  hosts: stanley-arm1
  gather_facts: false
  become: true
  roles:
    - role: ../roles/fail2ban
    - role: ../roles/firewall

- name: Deploy security hardening to pam-amd1
  hosts: pam-amd1
  gather_facts: false
  become: true
  roles:
    - role: ../roles/fail2ban
    - role: ../roles/firewall

- name: Deploy security hardening to angela-amd2
  hosts: angela-amd2
  gather_facts: false
  become: true
  roles:
    - role: ../roles/fail2ban
    - role: ../roles/firewall
